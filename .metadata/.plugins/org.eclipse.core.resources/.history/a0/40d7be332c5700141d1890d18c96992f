package com.cl.feeds.dao;

import java.util.List;

import org.apache.log4j.Category;
import org.hibernate.SessionFactory;



/**
 *  DAO implementation built using Hibernate
 *
 *  @author Gibran E. Castillo
 */
public class HibernateSpringCollegeLifeDao  implements CollegeLifeDao {
	private SessionFactory sessionFactory;
	
	public void setSessionFactory(SessionFactory sessionFactory) {
		this.sessionFactory = sessionFactory;
	}
	
	public List<Category> getVideoCategories() throws DAOException {
		// TODO
		//
		// Execute the HQL "from com.cl.feeds.pojos.Post"
		return sessionFactory.getCurrentSession().createQuery("from com.cl.feeds.pojos.Post").list();
	}
	
	public List<VideoRecording> getVideoRecordings(String theCategory)throws DAOException{
		return getVideoRecordings(theCategory, VideoDao.SORT_BY_TITLE);
	}

	
	public List<VideoRecording> getVideoRecordings(String theCategory,
			int sortBy) throws DAOException {
		// TODO
		//
		// Notice how we execute the Named Query with a name parameter using HQL
    	return sessionFactory.getCurrentSession().getNamedQuery("VideoRecording.byCategory").setParameter("theCategory", theCategory).list();	
	}
	
	public VideoRecording getVideoRecording(String theRecordingId) throws DAOException {
		int recordingId =0;
		try {
			recordingId = Integer.parseInt(theRecordingId);
		} catch(NumberFormatException e) {
			// pending!!
		}
		
		return this.getVideoRecording(recordingId);
	}
	
	public VideoRecording getVideoRecording(int recordingId) throws DAOException {
		// TODO
		//
		// Notice how we execute the Named Query with a named parameter using HQL and return the result
		return (VideoRecording)sessionFactory.getCurrentSession().getNamedQuery("VideoRecording.Recording").setParameter("theRecordingId", recordingId).uniqueResult();
	}
}